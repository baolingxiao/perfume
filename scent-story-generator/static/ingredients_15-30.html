<!--
üå∏ È¶ôÊ∞¥Â∑•Âùä - È¶ôÊñôÈÄâÊã©È°µÈù¢
Last updated: 2025-07-01 15:27
Author: Perfume Workshop Team
Description: È¶ôÊñôÈÄâÊã©È°µÈù¢ÔºåÂ±ïÁ§∫ÂêÑÁßçÁ±ªÂûãÁöÑÈ¶ôÊñô‰æõÁî®Êà∑ÈÄâÊã©ÔºàÊûúÈ¶ô„ÄÅËä±È¶ô„ÄÅÊú®È¶ôÔºâ
-->
<!--
Last updated: 2024-03-19 15:30
Author: Perfume Workshop Team
Description: È¶ôÊñôÈÄâÊã©È°µÈù¢ÔºåÂ±ïÁ§∫ÂêÑÁßçÁ±ªÂûãÁöÑÈ¶ôÊñô‰æõÁî®Êà∑ÈÄâÊã©
-->
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÈÄâÊã©È¶ôÊñô - È¶ôÊ∞¥Â∑•Âùä</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/base_15-30.css?v=42">
    <link rel="stylesheet" href="css/ingredients_15-30.css?v=42">
    <style>
        .selected-list {
            display: flex;
            gap: 16px;
            justify-content: center;
            align-items: center;
            margin-top: 8px;
        }
        .selected-list .selected-img {
            width: 64px;
            height: 64px;
            object-fit: cover;
            background: #000;
            border-radius: 50%;
            clip-path: circle(50% at 50% 50%);
            border: 2px solid #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.12);
            transition: all 0.3s ease;
        }
        .selected-list .selected-img:hover {
            transform: scale(1.1);
            border-color: #007bff;
            box-shadow: 0 4px 16px rgba(0,123,255,0.3);
        }
        .selected-list .placeholder {
            width: 64px;
            height: 64px;
            border-radius: 50%;
            background: #eee;
            border: 2px dashed #ccc;
        }
        
        /* È¶ôÊ∞¥ÊïÖ‰∫ãÂå∫ÂüüÊ†∑Âºè */
        .perfume-story-section {
            margin-top: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 12px;
            border: 1px solid #dee2e6;
        }
        
        .perfume-story-section h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2em;
            display: flex;
            align-items: center;
        }
        
        .perfume-story-section h3::before {
            content: "üå∏";
            margin-right: 8px;
            font-size: 1.1em;
        }
        
        .story-placeholder {
            text-align: center;
            color: #6c757d;
            font-style: italic;
            padding: 20px;
        }
        
        .story-loading {
            text-align: center;
            padding: 30px;
        }
        
        .story-loading h3 {
            color: #495057;
            margin-bottom: 10px;
        }
        
        .story-loading p {
            color: #6c757d;
            margin-bottom: 20px;
        }
        
        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #007bff;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .story-result {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        .story-result h3 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.3em;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 10px;
        }
        
        .story-content {
            line-height: 1.8;
            color: #495057;
            margin-bottom: 20px;
            text-align: justify;
        }
        
        .story-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-top: 1px solid #e9ecef;
            font-size: 0.9em;
            color: #6c757d;
        }
        
        .story-error {
            text-align: center;
            padding: 30px;
            color: #dc3545;
        }
        
        .story-error h3 {
            color: #dc3545;
            margin-bottom: 10px;
        }
        
        .perfume-story-btn {
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            margin-left: 10px;
        }
        
        .perfume-story-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(40, 167, 69, 0.3);
        }

    </style>
</head>
<body>
    <nav class="main-nav">
        <div class="nav-content">
            <div class="logo">È¶ôÊ∞¥Â∑•Âùä</div>
            <ul class="nav-links">
                <li><a href="index_15-30.html">È¶ñÈ°µ</a></li>
                <li><a href="#about">ÂÖ≥‰∫éÊàë‰ª¨</a></li>
                <li><a href="#contact">ËÅîÁ≥ªÊñπÂºè</a></li>
            </ul>
        </div>
    </nav>

    <main class="ingredients-page">
        <h1 class="page-title">ÈÄâÊã©È¶ôÊñô</h1>
        
        <!-- È¶ôÊñôÁ±ªÂûãÈÄâÊã©Âô® -->
        <div class="fragrance-types">
            <button class="type-btn active" data-type="all">ÂÖ®ÈÉ®</button>
            <button class="type-btn" data-type="fruit">ÊûúÈ¶ô</button>
            <button class="type-btn" data-type="floral">Ëä±È¶ô</button>
            <button class="type-btn" data-type="woody">Êú®È¶ô</button>
        </div>

        <!-- È¶ôË∞ÉÈÄâÊã©Âô® -->
        <div class="note-selector">
            <button class="note-btn active" data-note="all">ÂÖ®ÈÉ®</button>
            <button class="note-btn" data-note="top">ÂâçË∞É</button>
            <button class="note-btn" data-note="middle">‰∏≠Ë∞É</button>
            <button class="note-btn" data-note="base">Â∞æË∞É</button>
        </div>

        <!-- È¶ôÊñôÂ±ïÁ§∫Âå∫Âüü -->
        <div class="ingredients-grid">
            <!-- ÊûúÈ¶ôÈÉ®ÂàÜ -->
            <div class="ingredient-category" id="fruit">
                <!-- ÊüëÊ©òÁ±ª - ÂâçË∞É -->
                <div class="ingredient-item" data-href="È¶ôÊü†Ê™¨.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/È¶ôÊü†Ê™¨.jpeg" alt="È¶ôÊü†Ê™¨ Bergamot" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È¶ôÊü†Ê™¨<br><span class='en'>Bergamot</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈùíÊü†.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÈùíÊü†.jpeg" alt="ÈùíÊü† Lime" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈùíÊü†<br><span class='en'>Lime</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê©ôÂ≠ê.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Ê©ôÂ≠ê.jpeg" alt="Ê©ôÂ≠ê Orange" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê©ôÂ≠ê<br><span class='en'>Orange</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ë°ÄÊ©ô.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Ë°ÄÊ©ô.jpeg" alt="Ë°ÄÊ©ô Blood Orange" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ë°ÄÊ©ô<br><span class='en'>Blood Orange</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊüöÂ≠ê.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÊüöÂ≠ê.jpeg" alt="ÊüöÂ≠ê Grapefruit" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊüöÂ≠ê<br><span class='en'>Grapefruit</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊüëÊ©ò.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÊüëÊ©ò.jpeg" alt="ÊüëÊ©ò Mandarin Orange" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊüëÊ©ò<br><span class='en'>Mandarin Orange</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈáëÊ°î.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÈáëÊ°î.jpg" alt="ÈáëÊ°î Kumquat" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈáëÊ°î<br><span class='en'>Kumquat</span></h3>
                </div>

                <!-- Ê∏ÖÊñ∞ÊûúÈ¶ô - ÂâçË∞É/‰∏≠Ë∞É -->
                <div class="ingredient-item" data-href="ËãπÊûú.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ËãπÊûú.jpeg" alt="ËãπÊûú Apple" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ËãπÊûú<br><span class='en'>Apple</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈùíËãπÊûú.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÈùíËãπÊûú.jpeg" alt="ÈùíËãπÊûú Green Apple" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈùíËãπÊûú<br><span class='en'>Green Apple</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê¢®.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Ê¢®.jpeg" alt="Ê¢® Pear" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê¢®<br><span class='en'>Pear</span></h3>
                </div>

                <!-- ÁîúÁæéÊûúÈ¶ô - ‰∏≠Ë∞É -->
                <div class="ingredient-item" data-href="Ê°ÉÂ≠ê.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Ê°ÉÂ≠ê.jpeg" alt="Ê°ÉÂ≠ê Peach" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê°ÉÂ≠ê<br><span class='en'>Peach</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê®±Ê°É.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Ê®±Ê°É.jpeg" alt="Ê®±Ê°É Cherry" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê®±Ê°É<br><span class='en'>Cherry</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊùéÂ≠ê.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÊùéÂ≠ê.jpeg" alt="ÊùéÂ≠ê Plum" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊùéÂ≠ê<br><span class='en'>Plum</span></h3>
                </div>
                <div class="ingredient-item" data-href="ËäíÊûú.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ËäíÊûú.jpeg" alt="ËäíÊûú Mango" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ËäíÊûú<br><span class='en'>Mango</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê§∞Â≠ê.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Ê§∞Â≠ê.jpeg" alt="Ê§∞Â≠ê Coconut" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê§∞Â≠ê<br><span class='en'>Coconut</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÁôæÈ¶ôÊûú.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÁôæÈ¶ôÊûú.jpeg" alt="ÁôæÈ¶ôÊûú Passion Fruit" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÁôæÈ¶ôÊûú<br><span class='en'>Passion Fruit</span></h3>
                </div>
                <div class="ingredient-item" data-href="Êú®Áìú.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Êú®Áìú.jpeg" alt="Êú®Áìú Papaya" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Êú®Áìú<br><span class='en'>Papaya</span></h3>
                </div>
                <div class="ingredient-item" data-href="È¶ôËïâ.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/È¶ôËïâ.jpeg" alt="È¶ôËïâ" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È¶ôËïâ<br><span class='en'>Banana</span></h3>
                </div>

                <!-- ÊµÜÊûúÁ±ª - ‰∏≠Ë∞É -->
                <div class="ingredient-item" data-href="ËçâËéì.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ËçâËéì.jpeg" alt="ËçâËéì Strawberry" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ËçâËéì<br><span class='en'>Strawberry</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ë¶ÜÁõÜÂ≠ê.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Ë¶ÜÁõÜÂ≠ê.jpeg" alt="Ë¶ÜÁõÜÂ≠ê Raspberry" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ë¶ÜÁõÜÂ≠ê<br><span class='en'>Raspberry</span></h3>
                </div>
                <div class="ingredient-item" data-href="ËìùËéì.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ËìùËéì.jpeg" alt="ËìùËéì Blueberry" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ËìùËéì<br><span class='en'>Blueberry</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈªëÂä†‰ªë.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÈªëÂä†‰ªë.jpeg" alt="ÈªëÂä†‰ªë Blackberry" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈªëÂä†‰ªë<br><span class='en'>Blackberry</span></h3>
                </div>

                <!-- ÈÖíÈ¶ôÁ±ª - Â∞æË∞É -->
                <div class="ingredient-item" data-href="È¶ôÊßüÁôΩÂÖ∞Âú∞.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/È¶ôÊßüÁôΩÂÖ∞Âú∞.jpeg" alt="È¶ôÊßüÁôΩÂÖ∞Âú∞ Champagne Cognac" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È¶ôÊßüÁôΩÂÖ∞Âú∞<br><span class='en'>Champagne Cognac</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê®±Ê°ÉÈÖí.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Ê®±Ê°ÉÈÖí.jpeg" alt="Ê®±Ê°ÉÈÖí Cherry Wine" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê®±Ê°ÉÈÖí<br><span class='en'>Cherry Wine</span></h3>
                </div>
            </div>

            <!-- Ëä±È¶ôÈÉ®ÂàÜ -->
            <div class="ingredient-category" id="floral">
                <!-- Ê∏ÖÊñ∞Ëä±È¶ô - ÂâçË∞É -->
                <div class="ingredient-item" data-href="Ê©ôËä±.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Ê©ôËä±.jpeg" alt="Ê©ôËä± Orange Blossom" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê©ôËä±<br><span class='en'>Orange Blossom</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈìÉÂÖ∞.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÈìÉÂÖ∞.jpeg" alt="ÈìÉÂÖ∞ Lily of the Valley" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈìÉÂÖ∞<br><span class='en'>Lily of the Valley</span></h3>
                </div>
                <div class="ingredient-item" data-href="Â∞èËãçÂÖ∞.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Â∞èËãçÂÖ∞.jpeg" alt="Â∞èËãçÂÖ∞ Freesia" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Â∞èËãçÂÖ∞<br><span class='en'>Freesia</span></h3>
                </div>
                <div class="ingredient-item" data-href="È£é‰ø°Â≠ê.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/È£é‰ø°Â≠ê.jpeg" alt="È£é‰ø°Â≠ê Hyacinth" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È£é‰ø°Â≠ê<br><span class='en'>Hyacinth</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈáëÈì∂Ëä±.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/ÈáëÈì∂Ëä±.jpeg" alt="ÈáëÈì∂Ëä± Honeysuckle" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈáëÈì∂Ëä±<br><span class='en'>Honeysuckle</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê®±Ëä±.html" data-note="top" style="text-decoration:none;">
                    <img src="images/ingredients/Ê®±Ëä±.jpeg" alt="Ê®±Ëä± Sakura" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê®±Ëä±<br><span class='en'>Sakura</span></h3>
                </div>

                <!-- ÁªèÂÖ∏Ëä±È¶ô - ‰∏≠Ë∞É -->
                <div class="ingredient-item" data-href="ËåâËéâ.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ËåâËéâ.jpeg" alt="ËåâËéâ" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ËåâËéâ<br><span class='en'>Jasmine</span></h3>
                </div>
                <div class="ingredient-item" data-href="Â§ßÈ©¨Â£´Èù©Áé´Áë∞.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Â§ßÈ©¨Â£´Èù©Áé´Áë∞.jpeg" alt="Â§ßÈ©¨Â£´Èù©Áé´Áë∞ Damask Rose" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Â§ßÈ©¨Â£´Èù©Áé´Áë∞<br><span class='en'>Damask Rose</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÂúüËÄ≥ÂÖ∂Áé´Áë∞.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÂúüËÄ≥ÂÖ∂Áé´Áë∞.jpeg" alt="ÂúüËÄ≥ÂÖ∂Áé´Áë∞ Turkish Rose" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÂúüËÄ≥ÂÖ∂Áé´Áë∞<br><span class='en'>Turkish Rose</span></h3>
                </div>
                <div class="ingredient-item" data-href="‰øùÂä†Âà©‰∫öÁé´Áë∞.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/‰øùÂä†Âà©‰∫öÁé´Áë∞.jpeg" alt="‰øùÂä†Âà©‰∫öÁé´Áë∞ Bulgarian Rose" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>‰øùÂä†Âà©‰∫öÁé´Áë∞<br><span class='en'>Bulgarian Rose</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÁôΩÂÖ∞Ëä±.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÁôΩÂÖ∞Ëä±.jpeg" alt="ÁôΩÂÖ∞Ëä± Magnolia" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÁôΩÂÖ∞Ëä±<br><span class='en'>Magnolia</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê†ÄÂ≠êËä±.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Ê†ÄÂ≠êËä±.jpeg" alt="Ê†ÄÂ≠êËä± Gardenia" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê†ÄÂ≠êËä±<br><span class='en'>Gardenia</span></h3>
                </div>
                <div class="ingredient-item" data-href="Á¥´ÁΩóÂÖ∞.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Á¥´ÁΩóÂÖ∞.jpeg" alt="Á¥´ÁΩóÂÖ∞ Violet" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Á¥´ÁΩóÂÖ∞<br><span class='en'>Violet</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÈáëÂêàÊ¨¢.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÈáëÂêàÊ¨¢.jpeg" alt="ÈáëÂêàÊ¨¢ Mimosa" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÈáëÂêàÊ¨¢<br><span class='en'>Mimosa</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÂêëÊó•Ëëµ.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/ÂêëÊó•Ëëµ.jpeg" alt="ÂêëÊó•Ëëµ Sunflower" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÂêëÊó•Ëëµ<br><span class='en'>Sunflower</span></h3>
                </div>
                <div class="ingredient-item" data-href="È∏°ËõãËä±.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/È∏°ËõãËä±.jpeg" alt="Ê¢îÂ≠êËä± Frangipani" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È∏°ËõãËä±<br><span class='en'>Frangipani</span></h3>
                </div>
                <div class="ingredient-item" data-href="Á∫¢ÂßúËä±.html" data-note="middle" style="text-decoration:none;">
                    <img src="images/ingredients/Á∫¢ÂßúËä±.jpeg" alt="Á∫¢ÂßúËä± Ginger Lily" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Á∫¢ÂßúËä±<br><span class='en'>Ginger Lily</span></h3>
                </div>

                <!-- ÊµìÈÉÅËä±È¶ô - Â∞æË∞É -->
                <div class="ingredient-item" data-href="Â§úÊù•È¶ô.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Â§úÊù•È¶ô.jpeg" alt="Â§úÊù•È¶ô Tuberose" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Â§úÊù•È¶ô<br><span class='en'>Tuberose</span></h3>
                </div>
                <div class="ingredient-item" data-href="È∏¢Â∞æËä±.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/È∏¢Â∞æËä±.jpeg" alt="È∏¢Â∞æËä± Iris" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È∏¢Â∞æËä±<br><span class='en'>Iris</span></h3>
                </div>
                <div class="ingredient-item" data-href="È∏≥È∏ØËåâËéâ.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/È∏≥È∏ØËåâËéâ.jpeg" alt="È∏≥È∏ØËåâËéâ Ylang-Ylang" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>È∏≥È∏ØËåâËéâ<br><span class='en'>Ylang-Ylang</span></h3>
                </div>
            </div>

            <!-- Êú®È¶ôÈÉ®ÂàÜ -->
            <div class="ingredient-category" id="woody">
                <div class="ingredient-item" data-href="Èõ™Êùæ.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Èõ™Êùæ.jpeg" alt="Èõ™Êùæ Cedarwood" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Èõ™Êùæ<br><span class='en'>Cedarwood</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê™ÄÈ¶ô.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Ê™ÄÈ¶ô.jpeg" alt="Ê™ÄÈ¶ô Sandalwood" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê™ÄÈ¶ô<br><span class='en'>Sandalwood</span></h3>
                </div>
                <div class="ingredient-item" data-href="Â≤©ÂÖ∞Ëçâ.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Â≤©ÂÖ∞Ëçâ.jpeg" alt="Â≤©ÂÖ∞Ëçâ Vetiver" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Â≤©ÂÖ∞Ëçâ<br><span class='en'>Vetiver</span></h3>
                </div>

                <div class="ingredient-item" data-href="Âè§Â∑¥È¶ôËÑÇÊú®.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Âè§Â∑¥È¶ôËÑÇÊú®.jpeg" alt="Âè§Â∑¥È¶ôËÑÇÊú® Guaiac Wood" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Âè§Â∑¥È¶ôËÑÇÊú®<br><span class='en'>Guaiac Wood</span></h3>
                </div>

                <div class="ingredient-item" data-href="Ê©°Êú®Ëãî.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Ê©°Êú®Ëãî.jpeg" alt="Ê©°Êú®Ëãî Oakmoss" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê©°Êú®Ëãî<br><span class='en'>Oakmoss</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊùâÊú®.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/ÊùâÊú®.jpeg" alt="ÊùâÊú® Fir" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊùâÊú®<br><span class='en'>Fir</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊùæÊú®.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/ÊùæÊú®.jpeg" alt="ÊùæÊú® Pine" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊùæÊú®<br><span class='en'>Pine</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÊüèÊú®.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/ÊüèÊú®.jpeg" alt="ÊüèÊú® Cypress" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÊüèÊú®<br><span class='en'>Cypress</span></h3>
                </div>
                <div class="ingredient-item" data-href="ÂπøËóøÈ¶ô.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/ÂπøËóøÈ¶ô.jpeg" alt="ÂπøËóøÈ¶ô Patchouli" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>ÂπøËóøÈ¶ô<br><span class='en'>Patchouli</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê©°Ëãî.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Ê©°Ëãî.jpeg" alt="Ê©°Ëãî Oakmoss" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê©°Ëãî<br><span class='en'>Oakmoss</span></h3>
                </div>
                <div class="ingredient-item" data-href="Èõ™ÊùæËãî.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Èõ™ÊùæËãî.jpeg" alt="Èõ™ÊùæËãîË∞É Cedar Moss" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Èõ™ÊùæËãîË∞É<br><span class='en'>Cedar Moss</span></h3>
                </div>
                <div class="ingredient-item" data-href="‰πåÊú®.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/‰πåÊú®.jpeg" alt="‰πåÊú® Oud / Agarwood" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>‰πåÊú®/Ê≤âÈ¶ô<br><span class='en'>Oud / Agarwood</span></h3>
                </div>
                <div class="ingredient-item" data-href="Ê°¶Êú®ÁÑ¶Ê≤π.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Ê°¶Êú®ÁÑ¶Ê≤π.jpeg" alt="Ê°¶Êú®ÁÑ¶Ê≤π Birch Tar" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Ê°¶Êú®ÁÑ¶Ê≤π<br><span class='en'>Birch Tar</span></h3>
                </div>





                <div class="ingredient-item" data-href="Èõ™ÊùæÈÜá.html" data-note="base" style="text-decoration:none;">
                    <img src="images/ingredients/Èõ™ÊùæÈÜá.jpeg" alt="Èõ™ÊùæÈÜá Cedrol" style="width:100%;height:80%;object-fit:cover;display:block;">
                    <div class="ingredient-bottom"></div>
                    <h3>Èõ™ÊùæÈÜá<br><span class='en'>Cedrol</span></h3>
                </div>
            </div>
        </div>

        <!-- Â∑≤ÈÄâÈ¶ôÊñôÂ±ïÁ§∫Âå∫ -->
        <div class="selected-ingredients">
            <h2>Â∑≤ÈÄâÊã©ÁöÑÈ¶ôÊñô</h2>
            <div class="action-buttons">
                <button id="generateStory" class="story-btn">ÁîüÊàêAIÊïÖ‰∫ã</button>
                <button id="generatePerfumeStory" class="perfume-story-btn">ÁîüÊàêÈ¶ôÊ∞¥ÊïÖ‰∫ã</button>
                <button id="debugBtn" class="debug-btn">Ë∞ÉËØï</button>
                <button id="clearAll" class="clear-btn">Ê∏ÖÁ©∫ÂÖ®ÈÉ®</button>
            </div>
            
            <!-- ÂâçË∞ÉÂå∫Âüü -->
            <div class="note-section">
                <h3>ÂâçË∞É Top Notes</h3>
                <div class="note-slots" data-note="top">
                    <div class="slot-item" data-index="0"><div class="placeholder">1</div></div>
                    <div class="slot-item" data-index="1"><div class="placeholder">2</div></div>
                    <div class="slot-item" data-index="2"><div class="placeholder">3</div></div>
                    <div class="slot-item" data-index="3"><div class="placeholder">4</div></div>
                    <div class="slot-item" data-index="4"><div class="placeholder">5</div></div>
                </div>
            </div>
            
            <!-- ‰∏≠Ë∞ÉÂå∫Âüü -->
            <div class="note-section">
                <h3>‰∏≠Ë∞É Heart Notes</h3>
                <div class="note-slots" data-note="heart">
                    <div class="slot-item" data-index="0"><div class="placeholder">1</div></div>
                    <div class="slot-item" data-index="1"><div class="placeholder">2</div></div>
                    <div class="slot-item" data-index="2"><div class="placeholder">3</div></div>
                    <div class="slot-item" data-index="3"><div class="placeholder">4</div></div>
                    <div class="slot-item" data-index="4"><div class="placeholder">5</div></div>
                </div>
            </div>
            
            <!-- Â∞æË∞ÉÂå∫Âüü -->
            <div class="note-section">
                <h3>Â∞æË∞É Base Notes</h3>
                <div class="note-slots" data-note="base">
                    <div class="slot-item" data-index="0"><div class="placeholder">1</div></div>
                    <div class="slot-item" data-index="1"><div class="placeholder">2</div></div>
                    <div class="slot-item" data-index="2"><div class="placeholder">3</div></div>
                    <div class="slot-item" data-index="3"><div class="placeholder">4</div></div>
                    <div class="slot-item" data-index="4"><div class="placeholder">5</div></div>
                </div>
            </div>
            
            <!-- È¶ôÊ∞¥ÊïÖ‰∫ãÁîüÊàêÂå∫Âüü -->
            <div class="perfume-story-section">
                <h3>È¶ôÊ∞¥ÊïÖ‰∫ã</h3>
                <div id="perfume-story-container">
                    <div class="story-placeholder">
                        <p>ÈÄâÊã©È¶ôÊñôÂêéÔºåÁÇπÂáª"ÁîüÊàêÈ¶ôÊ∞¥ÊïÖ‰∫ã"ÊåâÈíÆÊù•Âàõ‰ΩúÊÇ®ÁöÑ‰∏ìÂ±ûÈ¶ôÊ∞¥ÊïÖ‰∫ã</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>
        // È¶ôÊñôÁ±ªÂûãÁ≠õÈÄâÂäüËÉΩ
        document.querySelectorAll('.type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // ÁßªÈô§ÊâÄÊúâactiveÁ±ª
                document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                // Ê∑ªÂä†activeÁ±ªÂà∞ÂΩìÂâçÊåâÈíÆ
                btn.classList.add('active');
                
                const type = btn.dataset.type;
                const items = document.querySelectorAll('.ingredient-item');
                
                if (type === 'all') {
                    // ÊòæÁ§∫ÊâÄÊúâÈ¶ôÊùê
                    items.forEach(item => item.classList.remove('hidden'));
                } else {
                    // Ê†πÊçÆÁ±ªÂûãÁ≠õÈÄâÈ¶ôÊùê
                    items.forEach(item => {
                        const category = item.closest('.ingredient-category');
                        if (category && category.id === type) {
                            item.classList.remove('hidden');
                        } else {
                            item.classList.add('hidden');
                        }
                    });
                }
            });
        });

        // È¶ôË∞ÉÁ≠õÈÄâÂäüËÉΩ
        document.querySelectorAll('.note-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                // ÁßªÈô§ÊâÄÊúâactiveÁ±ª
                document.querySelectorAll('.note-btn').forEach(b => b.classList.remove('active'));
                // Ê∑ªÂä†activeÁ±ªÂà∞ÂΩìÂâçÊåâÈíÆ
                btn.classList.add('active');
                
                const note = btn.dataset.note;
                const items = document.querySelectorAll('.ingredient-item');
                
                if (note === 'all') {
                    // ÊòæÁ§∫ÊâÄÊúâÈ¶ôÊùê
                    items.forEach(item => item.classList.remove('hidden'));
                } else {
                    // Ê†πÊçÆÈ¶ôË∞ÉÁ≠õÈÄâÈ¶ôÊùê
                    items.forEach(item => {
                        if (item.dataset.note === note) {
                            item.classList.remove('hidden');
                        } else {
                            item.classList.add('hidden');
                        }
                    });
                }
            });
        });

        // È¶ôÊñôÁõ¥Êé•ÈÄâÊã©ÂäüËÉΩ
        document.querySelectorAll('.ingredient-item').forEach(item => {
            item.addEventListener('click', (e) => {
                e.preventDefault();
                console.log('=== È¶ôÊñôÁÇπÂáª‰∫ã‰ª∂Ëß¶Âèë ===');
                
                // Ëé∑ÂèñÂΩìÂâçÈÄâ‰∏≠ÁöÑÈ¶ôË∞É
                const activeNoteBtn = document.querySelector('.note-btn.active');
                const selectedNote = activeNoteBtn ? activeNoteBtn.dataset.note : 'all';
                console.log('ÂΩìÂâçÈÄâ‰∏≠ÁöÑÈ¶ôË∞É:', selectedNote);
                
                // Â¶ÇÊûúÈÄâÊã©ÁöÑÊòØ"ÂÖ®ÈÉ®"ÔºåÂàôÊèêÁ§∫Áî®Êà∑ÈÄâÊã©È¶ôË∞É
                if (selectedNote === 'all') {
                    console.log('Áî®Êà∑ÈÄâÊã©‰∫Ü"ÂÖ®ÈÉ®"ÔºåÊòæÁ§∫ÊèêÁ§∫');
                    showToast('ËØ∑ÂÖàÈÄâÊã©È¶ôË∞ÉÔºàÂâçË∞É„ÄÅ‰∏≠Ë∞É„ÄÅÂ∞æË∞ÉÔºâÔºåÁÑ∂ÂêéÂÜçÁÇπÂáªÈ¶ôÊñô');
                    return;
                }
                
                // Ëé∑ÂèñÈ¶ôÊñô‰ø°ÊÅØ
                const ingredientName = item.querySelector('h3').textContent.split('\n')[0];
                const ingredientImage = item.querySelector('img').src;
                console.log('ÁÇπÂáªÁöÑÈ¶ôÊñô:', ingredientName);
                
                const ingredient = {
                    name: ingredientName,
                    image: ingredientImage.replace(window.location.origin + '/', '')
                };
                console.log('È¶ôÊñôÂØπË±°:', ingredient);
                
                // Â∞ÜÈ¶ôÊñôÊ∑ªÂä†Âà∞ÈÄâ‰∏≠ÁöÑÈ¶ôË∞É
                const noteTypeMap = {
                    'top': 'top',
                    'middle': 'heart',
                    'base': 'base'
                };
                
                const noteType = noteTypeMap[selectedNote];
                console.log('Êò†Â∞ÑÂêéÁöÑÈ¶ôË∞ÉÁ±ªÂûã:', noteType);
                
                if (noteType) {
                    console.log('Ë∞ÉÁî®addIngredientToSelectedNoteÂáΩÊï∞');
                    addIngredientToSelectedNote(ingredient, noteType);
                } else {
                    console.log('noteTypeÊò†Â∞ÑÂ§±Ë¥•');
                }
            });
        });

        (function(){
            // Êñ∞ÁöÑÊï∞ÊçÆÁªìÊûÑÔºöÊåâÈ¶ôË∞ÉÂàÜÁ±ªÂ≠òÂÇ®
            function getSelectedIngredients() {
                try {
                    const data = JSON.parse(localStorage.getItem('selectedIngredientsByNote') || '{}');
                    return {
                        top: data.top || [],
                        heart: data.heart || [],
                        base: data.base || []
                    };
                } catch(e) {
                    return { top: [], heart: [], base: [] };
                }
            }
            
            function saveSelectedIngredients(data) {
                console.log('=== ‰øùÂ≠òÈ¶ôÊñôÊï∞ÊçÆ ===');
                console.log('ÂáÜÂ§á‰øùÂ≠òÁöÑÊï∞ÊçÆ:', data);
                console.log('Êï∞ÊçÆJSONÂ≠óÁ¨¶‰∏≤:', JSON.stringify(data));
                localStorage.setItem('selectedIngredientsByNote', JSON.stringify(data));
                console.log('‰øùÂ≠òÂêéÁöÑlocalStorage:', localStorage.getItem('selectedIngredientsByNote'));
                console.log('=== ‰øùÂ≠òÂÆåÊàê ===');
            }
            
            // Ê∏≤ÊüìÂ∑≤ÈÄâÈ¶ôÊñô
            function renderSelectedIngredients() {
                const selected = getSelectedIngredients();
                
                // Ê∑ªÂä†Ë∞ÉËØï‰ø°ÊÅØ
                console.log('Ê∏≤ÊüìÂ∑≤ÈÄâÈ¶ôÊñô:', selected);
                console.log('ÂâçË∞ÉÊï∞ÊçÆ:', selected.top);
                console.log('‰∏≠Ë∞ÉÊï∞ÊçÆ:', selected.heart);
                console.log('Â∞æË∞ÉÊï∞ÊçÆ:', selected.base);
                
                // È¶ñÂÖàÊ∏ÖÈô§ÊâÄÊúâÈ¶ôÊñôÈ°πÁöÑÈÄâ‰∏≠Áä∂ÊÄÅ
                document.querySelectorAll('.ingredient-item').forEach(item => {
                    item.classList.remove('selected');
                });
                
                // È´ò‰∫ÆÊòæÁ§∫Â∑≤ÈÄâÊã©ÁöÑÈ¶ôÊñô
                const allSelectedIngredients = [...selected.top, ...selected.heart, ...selected.base];
                allSelectedIngredients.forEach(ingredient => {
                    const ingredientItem = Array.from(document.querySelectorAll('.ingredient-item')).find(item => {
                        const name = item.querySelector('h3').textContent.split('\n')[0];
                        return name === ingredient.name;
                    });
                    if (ingredientItem) {
                        ingredientItem.classList.add('selected');
                    }
                });
                
                ['top', 'heart', 'base'].forEach(noteType => {
                    // Ë∞ÉËØïÔºöÊü•ÁúãÊâÄÊúâdata-noteÂ±ûÊÄßÁöÑÂÖÉÁ¥†
                    const allDataNoteElements = document.querySelectorAll('[data-note]');
                    console.log(`ÊâÄÊúâdata-noteÂÖÉÁ¥†:`, allDataNoteElements);
                    allDataNoteElements.forEach(el => {
                        console.log(`ÂÖÉÁ¥†:`, el, `data-noteÂÄº:`, el.getAttribute('data-note'));
                    });
                    
                    // ‰øÆÂ§çÔºö‰∏ìÈó®Êü•Êâænote-slotsÁ±ªÁöÑÊèíÊßΩÂÆπÂô®
                    const noteSlots = document.querySelector(`.note-slots[data-note="${noteType}"]`);
                    console.log(`Êü•Êâæ ${noteType} ÊèíÊßΩÂÆπÂô®:`, noteSlots);
                    
                    if (!noteSlots) {
                        console.warn(`Êâæ‰∏çÂà∞ ${noteType} ÁöÑÊèíÊßΩÂÆπÂô®`);
                        return;
                    }
                    
                    const slots = noteSlots.querySelectorAll('.slot-item');
                    const ingredients = selected[noteType] || [];
                    
                    console.log(`${noteType} È¶ôË∞ÉÊúâ ${ingredients.length} ‰∏™È¶ôÊñô:`, ingredients);
                    console.log(`${noteType} ÊâæÂà∞ ${slots.length} ‰∏™ÊèíÊßΩ`);
                    
                    slots.forEach((slot, index) => {
                        const ingredient = ingredients[index];
                        console.log(`${noteType} ÊèíÊßΩ ${index}:`, ingredient);
                        
                        slot.innerHTML = '';
                        
                        if (ingredient) {
                            console.log(`Ê∏≤Êüì ${noteType} ÊèíÊßΩ ${index} ÁöÑÈ¶ôÊñô:`, ingredient.name);
                            console.log(`È¶ôÊñôÂõæÁâáË∑ØÂæÑ:`, ingredient.image);
                            
                            // ÊúâÈ¶ôÊñôÊó∂ÊòæÁ§∫ÂõæÁâá
                            const img = document.createElement('img');
                            // Á°Æ‰øùÂõæÁâáË∑ØÂæÑÊ≠£Á°Æ
                            const imgPath = ingredient.image.startsWith('/') ? ingredient.image : '/' + ingredient.image;
                            console.log(`ÊúÄÁªàÂõæÁâáË∑ØÂæÑ:`, imgPath);
                            img.src = imgPath;
                            img.alt = ingredient.name;
                            img.title = `ÁÇπÂáªÊü•Áúã ${ingredient.name} ËØ¶ÊÉÖ`;
                            img.style.cursor = 'pointer';
                            img.addEventListener('click', () => {
                                window.location.href = ingredient.name + '.html';
                            });
                            
                            // Ê∑ªÂä†Âà†Èô§ÊåâÈíÆ
                            const removeBtn = document.createElement('button');
                            removeBtn.className = 'remove-btn';
                            removeBtn.innerHTML = '√ó';
                            removeBtn.title = 'ÁßªÈô§È¶ôÊñô';
                            removeBtn.addEventListener('click', (e) => {
                                e.stopPropagation();
                                removeIngredient(noteType, index);
                            });
                            
                            slot.appendChild(img);
                            slot.appendChild(removeBtn);
                            slot.classList.add('filled');
                        } else {
                            // Á©∫‰ΩçÊòæÁ§∫Âç†‰ΩçÁ¨¶
                            const placeholder = document.createElement('div');
                            placeholder.className = 'placeholder';
                            placeholder.textContent = index + 1;
                            slot.appendChild(placeholder);
                            slot.classList.remove('filled');
                        }
                    });
                });
            }
            
            // ÁßªÈô§È¶ôÊñô
            function removeIngredient(noteType, index) {
                const selected = getSelectedIngredients();
                selected[noteType].splice(index, 1);
                saveSelectedIngredients(selected);
                renderSelectedIngredients();
                
                // ÊòæÁ§∫ÊèêÁ§∫
                const noteNames = { top: 'ÂâçË∞É', heart: '‰∏≠Ë∞É', base: 'Â∞æË∞É' };
                alert(`Â∑≤‰ªé${noteNames[noteType]}‰∏≠ÁßªÈô§È¶ôÊñô`);
            }
            
            // Ê∏ÖÁ©∫ÊâÄÊúâÈ¶ôÊñô
            function clearAllIngredients() {
                if (confirm('Á°ÆÂÆöË¶ÅÊ∏ÖÁ©∫ÊâÄÊúâÂ∑≤ÈÄâÊã©ÁöÑÈ¶ôÊñôÂêóÔºü')) {
                    const emptyData = { top: [], heart: [], base: [] };
                    saveSelectedIngredients(emptyData);
                    renderSelectedIngredients();
                    alert('Â∑≤Ê∏ÖÁ©∫ÊâÄÊúâÈ¶ôÊñôÈÄâÊã©');
                }
            }
            
            // ÁîüÊàêAIÊïÖ‰∫ã
            function generateAIStory() {
                const selected = getSelectedIngredients();
                const allIngredients = [...selected.top, ...selected.heart, ...selected.base];
                
                if (allIngredients.length === 0) {
                    alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∫õÈ¶ôÊñôÔºÅ');
                    return;
                }
                
                console.log('=== ÁîüÊàêAIÊïÖ‰∫ã ===');
                console.log('ÈÄâ‰∏≠ÁöÑÈ¶ôÊñôÊï∞ÊçÆ:', selected);
                console.log('ÊâÄÊúâÈ¶ôÊñô:', allIngredients);
                
                // ËΩ¨Êç¢Êï∞ÊçÆÊ†ºÂºè‰∏∫AIÊïÖ‰∫ãÁîüÊàêÂô®ÊâÄÈúÄÁöÑÊ†ºÂºè
                const storyIngredients = allIngredients.map((ingredient, index) => ({
                    id: `ingredient_${index}`,
                    name: ingredient.name,
                    image: ingredient.image,
                    ratio: 0 // ÂàùÂßãÊØî‰æã‰∏∫0ÔºåÁî®Êà∑ÂèØÂú®ÊïÖ‰∫ãÁîüÊàêÈ°µÈù¢Ë∞ÉÊï¥
                }));
                
                console.log('ËΩ¨Êç¢ÂêéÁöÑÈ¶ôÊñôÊï∞ÊçÆ:', storyIngredients);
                
                // ‰øùÂ≠òÂà∞localStorage‰æõAIÊïÖ‰∫ãÁîüÊàêÂô®‰ΩøÁî®
                localStorage.setItem('selectedIngredients', JSON.stringify(storyIngredients));
                console.log('Â∑≤‰øùÂ≠òÂà∞selectedIngredients');
                
                // ÂêåÊó∂‰øùÂ≠òÂéüÂßãÊ†ºÂºèÂà∞selectedIngredientsByNoteÔºà‰ª•Èò≤‰∏á‰∏ÄÔºâ
                localStorage.setItem('selectedIngredientsByNote', JSON.stringify(selected));
                console.log('Â∑≤‰øùÂ≠òÂà∞selectedIngredientsByNote');
                
                // ÈÄöËøáURLÂèÇÊï∞‰º†ÈÄíÈ¶ôÊñôÊï∞ÊçÆ
                const ingredientsParam = encodeURIComponent(JSON.stringify(storyIngredients));
                const url = `http://localhost:8080/static/scent_story_generator.html?ingredients=${ingredientsParam}`;
                console.log('Ë∑≥ËΩ¨URL:', url);
                
                // Ë∑≥ËΩ¨Âà∞AIÊïÖ‰∫ãÁîüÊàêÈ°µÈù¢
                window.open(url, '_blank');
            }
            
            // ÁîüÊàêÈ¶ôÊ∞¥ÊïÖ‰∫ãÔºàÊñ∞ÂäüËÉΩÔºâ
            async function generatePerfumeStory() {
                const selected = getSelectedIngredients();
                const allIngredients = [...selected.top, ...selected.heart, ...selected.base];
                
                if (allIngredients.length === 0) {
                    alert('ËØ∑ÂÖàÈÄâÊã©‰∏Ä‰∫õÈ¶ôÊñôÔºÅ');
                    return;
                }
                
                // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
                const storyContainer = document.getElementById('perfume-story-container');
                storyContainer.innerHTML = `
                    <div class="story-loading">
                        <h3>Ê≠£Âú®Âàõ‰ΩúÊÇ®ÁöÑÈ¶ôÊ∞¥ÊïÖ‰∫ã...</h3>
                        <p>AIÊ≠£Âú®Ê†πÊçÆÊÇ®ÈÄâÊã©ÁöÑÈ¶ôÊñôÁªÑÂêàÊûÑÊÄù‰∏Ä‰∏™Áã¨ÁâπÁöÑÈ¶ôÊ∞¥ÊïÖ‰∫ã</p>
                        <div class="loading-spinner"></div>
                    </div>
                `;
                
                try {
                    // ÂáÜÂ§áÈ¶ôÊñôÊï∞ÊçÆ
                    const ingredients = allIngredients.map(ingredient => ingredient.name);
                    
                    // Ë∞ÉÁî®APIÁîüÊàêÊïÖ‰∫ã
                    const response = await fetch('http://localhost:8080/api/generate', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            ingredients: ingredients,
                            aiProvider: 'openai'
                        })
                    });
                    
                    if (!response.ok) {
                        throw new Error(`HTTP error! status: ${response.status}`);
                    }
                    
                    const storyData = await response.json();
                    
                    if (storyData.error) {
                        throw new Error(storyData.error);
                    }
                    
                    // ÊòæÁ§∫ÁîüÊàêÁöÑÊïÖ‰∫ã
                    storyContainer.innerHTML = `
                        <div class="story-result">
                            <h3>${storyData.title}</h3>
                            <div class="story-content">
                                ${storyData.content.replace(/\n/g, '<br>')}
                            </div>
                            <div class="story-meta">
                                <span class="story-time">ÁîüÊàêÊó∂Èó¥: ${new Date(storyData.generated_at * 1000).toLocaleString()}</span>
                                <span class="story-ai">AI: ChatGPT</span>
                            </div>
                            <button onclick="generatePerfumeStory()" class="btn btn-primary">ÈáçÊñ∞ÁîüÊàê</button>
                        </div>
                    `;
                    
                } catch (error) {
                    console.error('ÁîüÊàêÈ¶ôÊ∞¥ÊïÖ‰∫ãÂ§±Ë¥•:', error);
                    storyContainer.innerHTML = `
                        <div class="story-error">
                            <h3>ÊïÖ‰∫ãÁîüÊàêÂ§±Ë¥•</h3>
                            <p>ÈîôËØØ‰ø°ÊÅØ: ${error.message}</p>
                            <p>ËØ∑Ê£ÄÊü•ÁΩëÁªúËøûÊé•ÊàñÁ®çÂêéÂÜçËØï</p>
                            <button onclick="generatePerfumeStory()" class="btn btn-primary">ÈáçËØï</button>
                        </div>
                    `;
                }
            }
            
            // Ê∑ªÂä†È¶ôÊñôÂà∞ÊåáÂÆöÈ¶ôË∞É
            function addIngredientToNote(ingredient, noteType) {
                const selected = getSelectedIngredients();
                const noteIngredients = selected[noteType];
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®
                const exists = noteIngredients.some(item => item.name === ingredient.name);
                if (exists) {
                    alert('ËØ•È¶ôÊñôÂ∑≤Âú®Ê≠§È¶ôË∞É‰∏≠');
                    return false;
                }
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Êª°
                if (noteIngredients.length >= 5) {
                    alert('ËØ•È¶ôË∞ÉÂ∑≤Êª°ÔºåÊúÄÂ§öÂè™ËÉΩÈÄâÊã©5ÁßçÈ¶ôÊñô');
                    return false;
                }
                
                // Ê∑ªÂä†È¶ôÊñô
                noteIngredients.push(ingredient);
                console.log('=== Ê∑ªÂä†È¶ôÊñôÂêé ===');
                console.log('ÂΩìÂâçÈ¶ôË∞ÉÊï∞ÊçÆ:', selected);
                console.log('Ê∑ªÂä†ÁöÑÈ¶ôÊñô:', ingredient);
                saveSelectedIngredients(selected);
                renderSelectedIngredients();
                
                const noteNames = { top: 'ÂâçË∞É', heart: '‰∏≠Ë∞É', base: 'Â∞æË∞É' };
                alert(`Â∑≤Â∞Ü ${ingredient.name} Ê∑ªÂä†Âà∞${noteNames[noteType]} (${noteIngredients.length}/5)`);
                return true;
            }
            
            // Ê∑ªÂä†È¶ôÊñôÂà∞ÈÄâ‰∏≠ÁöÑÈ¶ôË∞ÉÔºàÁî®‰∫é‰∏ªÈ°µÈù¢Áõ¥Êé•ÈÄâÊã©Ôºâ
            function addIngredientToSelectedNote(ingredient, noteType) {
                const selected = getSelectedIngredients();
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤ÁªèÂú®ÂÖ∂‰ªñÈ¶ôË∞É‰∏≠ÈÄâÊã©‰∫ÜËøô‰∏™È¶ôÊñô
                let existingNote = null;
                for (const [note, ingredients] of Object.entries(selected)) {
                    if (ingredients.some(item => item.name === ingredient.name)) {
                        existingNote = note;
                        break;
                    }
                }
                
                // Â¶ÇÊûúÂ∑≤ÁªèÂú®ÂÖ∂‰ªñÈ¶ôË∞É‰∏≠ÔºåÂÖàÁßªÈô§
                if (existingNote && existingNote !== noteType) {
                    const index = selected[existingNote].findIndex(item => item.name === ingredient.name);
                    if (index > -1) {
                        selected[existingNote].splice(index, 1);
                    }
                }
                
                const noteIngredients = selected[noteType];
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®‰∫éËØ•È¶ôË∞É
                const exists = noteIngredients.some(item => item.name === ingredient.name);
                if (exists) {
                    // Â¶ÇÊûúÂ∑≤Â≠òÂú®ÔºåÂàôÁßªÈô§ÔºàÂèñÊ∂àÈÄâÊã©Ôºâ
                    const index = noteIngredients.findIndex(item => item.name === ingredient.name);
                    noteIngredients.splice(index, 1);
                    saveSelectedIngredients(selected);
                    renderSelectedIngredients();
                    
                    const noteNames = { top: 'ÂâçË∞É', heart: '‰∏≠Ë∞É', base: 'Â∞æË∞É' };
                    showToast(`Â∑≤‰ªé${noteNames[noteType]}‰∏≠ÁßªÈô§ ${ingredient.name}`);
                    return;
                }
                
                // Ê£ÄÊü•ÊòØÂê¶Â∑≤Êª°
                if (noteIngredients.length >= 5) {
                    showToast('ËØ•È¶ôË∞ÉÂ∑≤Êª°ÔºåÊúÄÂ§öÂè™ËÉΩÈÄâÊã©5ÁßçÈ¶ôÊñô');
                    return;
                }
                
                // Ê∑ªÂä†È¶ôÊñô
                noteIngredients.push(ingredient);
                saveSelectedIngredients(selected);
                renderSelectedIngredients();
                
                const noteNames = { top: 'ÂâçË∞É', heart: '‰∏≠Ë∞É', base: 'Â∞æË∞É' };
                showToast(`Â∑≤Â∞Ü ${ingredient.name} Ê∑ªÂä†Âà∞${noteNames[noteType]} (${noteIngredients.length}/5)`);
            }
            
            // ÊòæÁ§∫ÊèêÁ§∫‰ø°ÊÅØ
            function showToast(message) {
                // ÁßªÈô§Â∑≤Â≠òÂú®ÁöÑÊèêÁ§∫
                const existingToast = document.querySelector('.toast-message');
                if (existingToast) {
                    existingToast.remove();
                }
                
                const toast = document.createElement('div');
                toast.className = 'toast-message';
                toast.textContent = message;
                toast.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #28a745;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 4px;
                    z-index: 1000;
                    font-size: 14px;
                    box-shadow: 0 2px 8px rgba(0,0,0,0.2);
                    transform: translateX(100%);
                    transition: transform 0.3s ease;
                `;
                
                document.body.appendChild(toast);
                
                // ÊòæÁ§∫Âä®Áîª
                setTimeout(() => {
                    toast.style.transform = 'translateX(0)';
                }, 10);
                
                // 3ÁßíÂêéÈöêËóè
                setTimeout(() => {
                    toast.style.transform = 'translateX(100%)';
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            }
            
            // ‰ªéÊóßÊ†ºÂºèËøÅÁßªÊï∞ÊçÆ
            function migrateOldData() {
                const oldData = localStorage.getItem('selectedIngredients');
                if (oldData) {
                    try {
                        const ingredients = JSON.parse(oldData);
                        if (ingredients.length > 0) {
                            // Â∞ÜÊóßÊï∞ÊçÆÊ∏ÖÁ©∫ÔºåÁî®Êà∑ÈúÄË¶ÅÈáçÊñ∞ÈÄâÊã©Âπ∂ÊåáÂÆöÈ¶ôË∞É
                            localStorage.removeItem('selectedIngredients');
                            console.log('Â∑≤Ê∏ÖÁêÜÊóßÁöÑÈÄâÊã©Êï∞ÊçÆÔºåËØ∑ÈáçÊñ∞ÈÄâÊã©È¶ôÊñôÂπ∂ÊåáÂÆöÈ¶ôË∞É');
                        }
                    } catch(e) {}
                }
            }

            // ÂØºÂá∫ÂáΩÊï∞Âà∞ÂÖ®Â±Ä
            window.renderSelectedIngredients = renderSelectedIngredients;
            window.clearAllIngredients = clearAllIngredients;
            window.addIngredientToNote = addIngredientToNote;
            window.getSelectedIngredients = getSelectedIngredients;
            
            // ÂàùÂßãÂåñ
            migrateOldData();
            renderSelectedIngredients();
            
            // ÁªëÂÆöÊ∏ÖÁ©∫ÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('clearAll').addEventListener('click', clearAllIngredients);
            
            // ÁªëÂÆöË∞ÉËØïÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('debugBtn').addEventListener('click', function() {
                const data = getSelectedIngredients();
                console.log('ÂΩìÂâçlocalStorageÊï∞ÊçÆ:', data);
                alert('ÂΩìÂâçlocalStorageÊï∞ÊçÆ:\n' + JSON.stringify(data, null, 2));
                
                // Âº∫Âà∂ÈáçÊñ∞Ê∏≤Êüì
                renderSelectedIngredients();
            });
            
            // ÁªëÂÆöÁîüÊàêAIÊïÖ‰∫ãÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('generateStory').addEventListener('click', generateAIStory);
            
            // ÁªëÂÆöÁîüÊàêÈ¶ôÊ∞¥ÊïÖ‰∫ãÊåâÈíÆ‰∫ã‰ª∂
            document.getElementById('generatePerfumeStory').addEventListener('click', generatePerfumeStory);
            
            // È°µÈù¢Âä†ËΩΩÊó∂ÂêåÊ≠•ÈÄâÊã©Áä∂ÊÄÅ
            document.addEventListener('DOMContentLoaded', function() {
                renderSelectedIngredients();
            });
            
            // ÁõëÂê¨localStorageÂèòÂåñÔºåÂÆûÊó∂Êõ¥Êñ∞ÊòæÁ§∫
            window.addEventListener('storage', function(e) {
                if (e.key === 'selectedIngredientsByNote') {
                    renderSelectedIngredients();
                }
                if (e.key === 'selectedIngredientsByNote_trigger') {
                    console.log('Êî∂Âà∞Ëß¶ÂèëÂô®‰ø°Âè∑ÔºåÈáçÊñ∞Ê∏≤ÊüìÈÄâÊã©Áä∂ÊÄÅ');
                    renderSelectedIngredients();
                }
            });
            
            // ÁõëÂê¨È°µÈù¢ÁÑ¶ÁÇπÊÅ¢Â§çÔºåÈáçÊñ∞Ê∏≤ÊüìÈÄâÊã©Áä∂ÊÄÅ
            window.addEventListener('focus', function() {
                console.log('È°µÈù¢ÊÅ¢Â§çÁÑ¶ÁÇπÔºåÈáçÊñ∞Ê∏≤ÊüìÈÄâÊã©Áä∂ÊÄÅ');
                renderSelectedIngredients();
            });
            
            // ÁõëÂê¨È°µÈù¢ÂèØËßÅÊÄßÂèòÂåñ
            document.addEventListener('visibilitychange', function() {
                if (!document.hidden) {
                    console.log('È°µÈù¢Âèò‰∏∫ÂèØËßÅÔºåÈáçÊñ∞Ê∏≤ÊüìÈÄâÊã©Áä∂ÊÄÅ');
                    renderSelectedIngredients();
                }
            });
            
            // ÂÆöÊúüÊ£ÄÊü•localStorageÂèòÂåñÔºàÂ§áÁî®ÊñπÊ°àÔºâ
            let lastDataString = JSON.stringify(getSelectedIngredients());
            setInterval(function() {
                const currentDataString = JSON.stringify(getSelectedIngredients());
                if (currentDataString !== lastDataString) {
                    console.log('Ê£ÄÊµãÂà∞localStorageÊï∞ÊçÆÂèòÂåñÔºåÈáçÊñ∞Ê∏≤Êüì');
                    renderSelectedIngredients();
                    lastDataString = currentDataString;
                }
            }, 1000); // ÊØèÁßíÊ£ÄÊü•‰∏ÄÊ¨°
        })();
    </script>
    <script src="perfume-workshop/static/scent_story_interaction.js"></script>
</body>
</html> 